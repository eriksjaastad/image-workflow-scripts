[*] Using device: mps
[*] Loading embeddings from data/ai_data/cache/processed_images.jsonl...
[*] Loaded 22514 embeddings
[*] Loading crop training data from data/training/select_crop_log.csv...
[*] Loaded 3242 crop examples (3952 skipped)
[*] Train: 2756 examples
[*] Val: 486 examples

[*] Starting training for 50 epochs...

Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:   1%|          | 1/87 [00:01<01:26,  1.01s/it]Training:  44%|████▎     | 38/87 [00:01<00:01, 46.55it/s]Training:  86%|████████▌ | 75/87 [00:01<00:00, 94.76it/s]                                                         Validating:   0%|          | 0/16 [00:00<?, ?it/s]Validating: 100%|██████████| 16/16 [00:00<00:00, 37.75it/s]                                                           Epoch 1/50 - Train Loss: 0.029837, Val Loss: 0.022975
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  43%|████▎     | 37/87 [00:00<00:00, 367.33it/s]Training:  87%|████████▋ | 76/87 [00:00<00:00, 379.08it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 2/50 - Train Loss: 0.017702, Val Loss: 0.020490
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  43%|████▎     | 37/87 [00:00<00:00, 364.61it/s]Training:  85%|████████▌ | 74/87 [00:00<00:00, 347.15it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 3/50 - Train Loss: 0.016030, Val Loss: 0.020137
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  44%|████▎     | 38/87 [00:00<00:00, 376.54it/s]Training:  87%|████████▋ | 76/87 [00:00<00:00, 321.93it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 4/50 - Train Loss: 0.015394, Val Loss: 0.019814
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  37%|███▋      | 32/87 [00:00<00:00, 317.24it/s]Training:  77%|███████▋  | 67/87 [00:00<00:00, 334.13it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 5/50 - Train Loss: 0.014426, Val Loss: 0.020493
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 387.58it/s]Training:  90%|████████▉ | 78/87 [00:00<00:00, 386.05it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 6/50 - Train Loss: 0.014075, Val Loss: 0.020085
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  36%|███▌      | 31/87 [00:00<00:00, 305.30it/s]Training:  71%|███████▏  | 62/87 [00:00<00:00, 301.63it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 7/50 - Train Loss: 0.013396, Val Loss: 0.017665
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  11%|█▏        | 10/87 [00:00<00:00, 87.25it/s]Training:  22%|██▏       | 19/87 [00:00<00:00, 88.52it/s]Training:  44%|████▎     | 38/87 [00:00<00:00, 132.72it/s]Training:  75%|███████▍  | 65/87 [00:00<00:00, 185.61it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 8/50 - Train Loss: 0.013110, Val Loss: 0.017126
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  40%|████      | 35/87 [00:00<00:00, 345.53it/s]Training:  80%|████████  | 70/87 [00:00<00:00, 339.77it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 9/50 - Train Loss: 0.012638, Val Loss: 0.019999
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  41%|████▏     | 36/87 [00:00<00:00, 352.37it/s]Training:  86%|████████▌ | 75/87 [00:00<00:00, 369.03it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 10/50 - Train Loss: 0.012057, Val Loss: 0.017742
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  44%|████▎     | 38/87 [00:00<00:00, 371.75it/s]Training:  87%|████████▋ | 76/87 [00:00<00:00, 354.67it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 11/50 - Train Loss: 0.012294, Val Loss: 0.018872
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 391.85it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 393.64it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 12/50 - Train Loss: 0.011918, Val Loss: 0.017961
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  43%|████▎     | 37/87 [00:00<00:00, 362.56it/s]Training:  87%|████████▋ | 76/87 [00:00<00:00, 377.52it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 13/50 - Train Loss: 0.011378, Val Loss: 0.017517
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 389.78it/s]Training:  90%|████████▉ | 78/87 [00:00<00:00, 389.49it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 14/50 - Train Loss: 0.011629, Val Loss: 0.017609
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  41%|████▏     | 36/87 [00:00<00:00, 359.76it/s]Training:  85%|████████▌ | 74/87 [00:00<00:00, 370.60it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 15/50 - Train Loss: 0.011263, Val Loss: 0.017503
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 382.19it/s]Training:  90%|████████▉ | 78/87 [00:00<00:00, 375.30it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 16/50 - Train Loss: 0.011040, Val Loss: 0.017077
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 383.04it/s]Training:  90%|████████▉ | 78/87 [00:00<00:00, 381.94it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 17/50 - Train Loss: 0.010533, Val Loss: 0.016640
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 386.53it/s]Training:  90%|████████▉ | 78/87 [00:00<00:00, 387.77it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 18/50 - Train Loss: 0.010302, Val Loss: 0.016362
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 382.77it/s]Training:  90%|████████▉ | 78/87 [00:00<00:00, 380.53it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 19/50 - Train Loss: 0.010198, Val Loss: 0.017593
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  43%|████▎     | 37/87 [00:00<00:00, 361.64it/s]Training:  87%|████████▋ | 76/87 [00:00<00:00, 377.63it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 20/50 - Train Loss: 0.010396, Val Loss: 0.016776
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 393.96it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 392.56it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 21/50 - Train Loss: 0.009908, Val Loss: 0.016975
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 388.85it/s]Training:  91%|█████████ | 79/87 [00:00<00:00, 389.63it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 22/50 - Train Loss: 0.009866, Val Loss: 0.017960
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 390.36it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 389.76it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 23/50 - Train Loss: 0.009617, Val Loss: 0.017575
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 390.62it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 382.02it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 24/50 - Train Loss: 0.009454, Val Loss: 0.018024
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 394.05it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 392.65it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 25/50 - Train Loss: 0.009389, Val Loss: 0.017247
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 391.45it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 384.16it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 26/50 - Train Loss: 0.009190, Val Loss: 0.019064
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 396.22it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 395.34it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 27/50 - Train Loss: 0.009115, Val Loss: 0.017134
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 391.09it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 392.99it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 28/50 - Train Loss: 0.008784, Val Loss: 0.018774
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 395.40it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 396.90it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 29/50 - Train Loss: 0.008610, Val Loss: 0.018375
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 397.19it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 396.10it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 30/50 - Train Loss: 0.009213, Val Loss: 0.017421
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 390.45it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 394.37it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 31/50 - Train Loss: 0.008532, Val Loss: 0.018070
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 397.71it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 398.07it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 32/50 - Train Loss: 0.008240, Val Loss: 0.017538
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  47%|████▋     | 41/87 [00:00<00:00, 399.94it/s]Training:  94%|█████████▍| 82/87 [00:00<00:00, 400.99it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 33/50 - Train Loss: 0.008203, Val Loss: 0.017475
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 398.64it/s]Training:  93%|█████████▎| 81/87 [00:00<00:00, 399.66it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 34/50 - Train Loss: 0.008235, Val Loss: 0.017290
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 379.45it/s]Training:  91%|█████████ | 79/87 [00:00<00:00, 380.53it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 35/50 - Train Loss: 0.008236, Val Loss: 0.017022
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 396.03it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 395.12it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 36/50 - Train Loss: 0.008158, Val Loss: 0.017961
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 380.86it/s]Training:  90%|████████▉ | 78/87 [00:00<00:00, 385.27it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 37/50 - Train Loss: 0.007758, Val Loss: 0.018913
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  44%|████▎     | 38/87 [00:00<00:00, 371.13it/s]Training:  90%|████████▉ | 78/87 [00:00<00:00, 382.51it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 38/50 - Train Loss: 0.007728, Val Loss: 0.018132
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 384.06it/s]Training:  91%|█████████ | 79/87 [00:00<00:00, 389.42it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 39/50 - Train Loss: 0.007513, Val Loss: 0.017687
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  36%|███▌      | 31/87 [00:00<00:00, 295.83it/s]Training:  76%|███████▌  | 66/87 [00:00<00:00, 326.75it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 40/50 - Train Loss: 0.007509, Val Loss: 0.018007
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 391.09it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 393.92it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 41/50 - Train Loss: 0.007694, Val Loss: 0.019126
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  47%|████▋     | 41/87 [00:00<00:00, 400.58it/s]Training:  94%|█████████▍| 82/87 [00:00<00:00, 399.53it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 42/50 - Train Loss: 0.007507, Val Loss: 0.018224
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 399.60it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 397.06it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 43/50 - Train Loss: 0.007400, Val Loss: 0.018168
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 397.50it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 393.67it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 44/50 - Train Loss: 0.007223, Val Loss: 0.019076
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 392.57it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 394.29it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 45/50 - Train Loss: 0.007404, Val Loss: 0.018809
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 399.89it/s]Training:  93%|█████████▎| 81/87 [00:00<00:00, 400.98it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 46/50 - Train Loss: 0.007207, Val Loss: 0.017487
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 399.86it/s]Training:  93%|█████████▎| 81/87 [00:00<00:00, 400.46it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 47/50 - Train Loss: 0.007117, Val Loss: 0.019075
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  43%|████▎     | 37/87 [00:00<00:00, 361.71it/s]Training:  85%|████████▌ | 74/87 [00:00<00:00, 362.87it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 48/50 - Train Loss: 0.007568, Val Loss: 0.019160
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  46%|████▌     | 40/87 [00:00<00:00, 393.31it/s]Training:  92%|█████████▏| 80/87 [00:00<00:00, 392.99it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 49/50 - Train Loss: 0.007403, Val Loss: 0.017818
Training:   0%|          | 0/87 [00:00<?, ?it/s]Training:  45%|████▍     | 39/87 [00:00<00:00, 382.07it/s]Training:  90%|████████▉ | 78/87 [00:00<00:00, 375.15it/s]                                                          Validating:   0%|          | 0/16 [00:00<?, ?it/s]                                                  Epoch 50/50 - Train Loss: 0.006914, Val Loss: 0.019019

[*] Training complete!
[*] Best epoch: 18
[*] Best val loss: 0.016362
[*] Model saved to: data/ai_data/models/crop_proposer_v1.pt
[*] Metadata saved to: data/ai_data/models/crop_proposer_v1_metadata.json
